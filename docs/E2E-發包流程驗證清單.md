# E2E 發包流程驗證清單

更新：2026-02-06

請依序手動執行，確認核心發包流程與「移除此廠商」正常。

---

## 前置

- [ ] 後端 `node server.js` 已啟動（如 port 3000）
- [ ] 前台已登入**發案者**帳號
- [ ] 至少有一個專案（可從「我的專案」進入專案詳情）
- [ ] 專案內有至少一筆**分包項目**（有分類、預算、可勾選）

---

## 步驟一：專案詳情 → 勾選工項

1. 進入 **專案詳情** 頁（從「我的專案」點進任一專案）。
2. 在 **分包項目** 表格中，勾選要發包的項目（可含已發包項目，run-split 允許重新發包）。
3. 確認勾選後，可選編輯工項的**標籤**（若有「同類專家常用標籤」可之後在預媒合後加入）。

---

## 步驟二：預媒合

1. 點 **「預媒合測試」**（或 ② 預媒合區塊內按鈕）。
2. 確認出現 **預媒合結果**：預算合理度、符合專家數、預期回應等。
3. （可選）點「查看詳細分析」展開；點「同類專家常用標籤」其中一個，確認可加入已勾選工項並寫入 DB。

---

## 步驟三：送出媒合

1. 確認工項已勾選，點 **「送出媒合」**（在分包項目表格區或 ③ 區塊）。
2. 確認有 **載入中** 提示，之後出現 **媒合結果**（各項目媒合到的專家數、Top 3 等）。
3. 到 DB 檢查 **project_matches**（或 `matches` 表）：應有對應 `project_id` + `expert_listing_id` 的紀錄，且無重複。

---

## 步驟四：移除此廠商

1. 在專案詳情頁 **已媒合專家** 列表找到任一廠商卡片。
2. 點 **「移除此廠商」**。
3. 確認：該卡片從畫面上消失（樂觀更新）；若後端刪除失敗，應有錯誤提示或還原。
4. 到 DB 確認該筆 match 已刪除。

---

## 步驟五：失敗還原（可選）

- 若「送出媒合」時故意使用無效 token 或錯誤 project_id，確認前端有錯誤訊息、不寫入錯誤資料。
- 若「移除此廠商」後端回傳失敗，確認前端有提示且可重試或還原顯示。

---

## 完成後

- 在 matchdo-todo 或本文件註記「E2E 發包流程已驗證（日期）」。
- 若有失敗步驟，記錄情境與錯誤訊息，供後續修正。

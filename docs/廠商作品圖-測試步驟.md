# 廠商作品圖 — 測試步驟

## 一、前置：執行 SQL（Supabase）

1. 若尚未有 **廠商資料表** 與示範廠商：在 Supabase **SQL Editor** 執行 **`docs/custom-products-schema.sql`**。
2. 建立 **廠商作品圖表**：執行 **`docs/manufacturer-portfolio-schema.sql`**。
3. （可選）塞一筆測試作品圖，之後不用上傳也能測「列表」：
   ```sql
   -- 任選一位廠商插入一筆作品圖（用 placeholder 圖）
   INSERT INTO public.manufacturer_portfolio (manufacturer_id, title, image_url, tags)
   SELECT id, '示範作品', 'https://placehold.co/400x300?text=Demo', ARRAY['家具', '訂製']
   FROM public.manufacturers WHERE is_active = true LIMIT 1;
   ```

---

## 二、啟動後端

```bash
npm start
```

確認出現 `Server running on port 3000`。

---

## 三、用瀏覽器或 curl 測試 API

### 1. 取得廠商清單（應帶出 `portfolio`）

- 瀏覽器開：  
  **http://localhost:3000/api/manufacturers**  
  或加分類：  
  **http://localhost:3000/api/manufacturers?category=furniture**
- 預期：JSON 裡每個廠商有 **`portfolio`** 陣列（有塞過測試資料的廠商會有一筆）。

### 2. 廠商作品圖列表（圖庫 API）

- **全部**：  
  http://localhost:3000/api/manufacturer-portfolio
- **單一廠商**：先從上面取得某個廠商 `id`，再開  
  http://localhost:3000/api/manufacturer-portfolio?manufacturer_id=<廠商UUID>
- **依分類**：  
  http://localhost:3000/api/manufacturer-portfolio?category=furniture
- **關鍵字**（標題／標籤）：  
  http://localhost:3000/api/manufacturer-portfolio?keyword=家具  

預期：`{ "items": [ ... ] }`，每筆含 `manufacturer_name`, `image_url`, `tags` 等。

### 3. 上傳廠商作品圖（需有廠商 ID）

用 **curl**（把 `廠商UUID` 換成實際 id，`路徑/到/圖片.jpg` 換成本機圖片）：

```bash
curl -X POST http://localhost:3000/api/manufacturers/廠商UUID/portfolio \
  -F "image=@路徑/到/圖片.jpg" \
  -F "title=我的作品" \
  -F "tags=木工,訂製"
```

或只送網址（不傳檔）：

```bash
curl -X POST "http://localhost:3000/api/manufacturers/廠商UUID/portfolio" \
  -H "Content-Type: application/json" \
  -d "{\"title\":\"範例\",\"image_url\":\"https://placehold.co/400x300\",\"tags\":[\"家具\"]}"
```

成功會回傳 201 與剛新增的那筆作品圖 JSON。

---

## 四、用腳本一次跑完（可選）

在專案根目錄執行：

```bash
node docs/test-manufacturer-portfolio-api.js
```

會依序呼叫上述 API 並把結果印在終端（需先啟動 server、且已執行過 SQL）。
